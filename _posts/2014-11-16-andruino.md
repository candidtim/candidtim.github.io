---
layout: post
title:  "Arduino+Android=Andruino"
date:   2014-11-16
categories: arduino
---
The goal of this POC is to build a system where an Arduino board (I have UNO) is connected to the Android phone, and an
Application on an Android phone would control the Arduino board. 

Having spent some time on the Android development quick start, I'm back to the challenge - connecting an Arduino to it. 

I've been considering several options. I know that Arduino allows serial communication over USB when connected to the
computer, and, after having implemented a small POC for it, I was looking for a way to program serial communication on
an Android phone via its USB connector - so, basically to replace a PC in this POC, by an Android. My Android phone
supports OTG, so connecting an Arduino to it shouldn't be a problem. 

In the end I've found a library allowing convenient programming of a serial communication over phone's USB, but
something else I've found when googling is a "firmata" protocol for Arduino. Apparently, Firmata protocol exposes same
commands as normally are exposed by Arduino's standard programming API, but over serial communication. You upload a
"Firmata" application to an Arduino board and it starts listening for commands on a serial port. And, turns out there
is an "AndroidFirmata" project - an implementation of Firmata protocol in a library for Android. 

This project however seems to be not updated for some time now, so, after having cloned it I had to fix few bugs related
to incompatibilities with latest Android SDKs, and, tah-dahm! It works. Here is the physical "architecture":

And the code:

{% highlight java %}
...
{% endhighlight %}

So, concept is proved - "Andruino" exists and works :)

As a last note, I still think I might eventually come back to the initial idea of programming the serial communication
myself, as I would probably want to expose more high-level commands. For now, Android application needs to send really
low level commands to an Arduino board, which has its benefits (for me - I will only need to code Java; and generally -
the implementation is simpler), but also has an easily noticeable drawback - latency. Even in this simple example, one
can see that between the moment the command is sent by Android application, and the action is performed by Arduino 
board, there is noticeable, by human, delay. Not sure how critical it is at this point, so I'll stick with current,
simpler solution for now.